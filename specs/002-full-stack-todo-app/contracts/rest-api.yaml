# API Contract: Todo Application REST API

## Base Path
`/api`

## Authentication
All endpoints require a valid JWT token in the Authorization header:
```
Authorization: Bearer <jwt-token>
```

## Common Error Responses
- `401 Unauthorized`: Invalid or missing JWT token
- `404 Not Found`: Resource not found or access denied (security best practice)
- `400 Bad Request`: Validation error
- `503 Service Unavailable`: Database connection failure

## Endpoints

### GET /api/{user_id}/tasks
**Description**: Retrieve all tasks for the authenticated user
**Authentication**: Required
**Parameters**:
- `user_id` (path): User ID from JWT must match this parameter
**Response**: `200 OK`
```json
{
  "tasks": [
    {
      "id": 1,
      "user_id": "user-123",
      "title": "Sample task",
      "description": "Sample description",
      "completed": false,
      "created_at": "2026-01-03T10:00:00Z",
      "updated_at": "2026-01-03T10:00:00Z"
    }
  ]
}
```
**Ordering**: Tasks ordered by created_at descending (newest first)

### POST /api/{user_id}/tasks
**Description**: Create a new task for the authenticated user
**Authentication**: Required
**Parameters**:
- `user_id` (path): User ID from JWT must match this parameter
**Request Body**:
```json
{
  "title": "Task title (required, 1-200 chars)",
  "description": "Optional task description (max 1000 chars)"
}
```
**Response**: `201 Created`
```json
{
  "id": 1,
  "user_id": "user-123",
  "title": "Task title",
  "description": "Task description",
  "completed": false,
  "created_at": "2026-01-03T10:00:00Z",
  "updated_at": "2026-01-03T10:00:00Z"
}
```

### GET /api/{user_id}/tasks/{id}
**Description**: Retrieve a specific task by ID
**Authentication**: Required
**Parameters**:
- `user_id` (path): User ID from JWT must match this parameter
- `id` (path): Task ID
**Response**: `200 OK`
```json
{
  "id": 1,
  "user_id": "user-123",
  "title": "Sample task",
  "description": "Sample description",
  "completed": false,
  "created_at": "2026-01-03T10:00:00Z",
  "updated_at": "2026-01-03T10:00:00Z"
}
```

### PUT /api/{user_id}/tasks/{id}
**Description**: Update an existing task
**Authentication**: Required
**Parameters**:
- `user_id` (path): User ID from JWT must match this parameter
- `id` (path): Task ID
**Request Body**:
```json
{
  "title": "Updated task title (required, 1-200 chars)",
  "description": "Updated task description (max 1000 chars)"
}
```
**Response**: `200 OK`
```json
{
  "id": 1,
  "user_id": "user-123",
  "title": "Updated task title",
  "description": "Updated task description",
  "completed": false,
  "created_at": "2026-01-03T10:00:00Z",
  "updated_at": "2026-01-03T11:00:00Z"
}
```

### DELETE /api/{user_id}/tasks/{id}
**Description**: Delete a task
**Authentication**: Required
**Parameters**:
- `user_id` (path): User ID from JWT must match this parameter
- `id` (path): Task ID
**Response**: `204 No Content`

### PATCH /api/{user_id}/tasks/{id}/complete
**Description**: Toggle task completion status
**Authentication**: Required
**Parameters**:
- `user_id` (path): User ID from JWT must match this parameter
- `id` (path): Task ID
**Request Body**:
```json
{
  "completed": true
}
```
**Response**: `200 OK`
```json
{
  "id": 1,
  "user_id": "user-123",
  "title": "Sample task",
  "description": "Sample description",
  "completed": true,
  "created_at": "2026-01-03T10:00:00Z",
  "updated_at": "2026-01-03T11:00:00Z"
}
```